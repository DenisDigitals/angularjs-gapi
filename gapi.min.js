"use strict";angular.module("gapi",[]),angular.module("gapi").provider("gapi",function(){var a={};this.apiKey=function(b){return a.api_key=b,this},this.clientId=function(b){return a.client_id=b,this},this.apiScope=function(b){return a.scope=b,this},this.$get=["$q",function(b){if(!a.api_key)throw"API key for Google is not set correctly";var c=b.defer(),d=!1,e=!1,f=c.promise;window.handleGAPIInit=function(){gapi.client.setApiKey(a.api_key),delete window.handleGAPIInit,d=!0,c.resolve()},jQuery("<script></script>").prop("src","https://apis.google.com/js/client.js?onload=handleGAPIInit").prop("type","text/javascript").appendTo("head");var g=function(a){return function(b){b&&!b.error?a.resolve():a.reject()}},h=function(c){var d=angular.extend(a,{immediate:!1},c||{}),e=b.defer();return f.then(function(){window.gapi.auth.authorize(d,g(e))}),e.promise};return{isApiReady:function(){return d},isAuth:function(){return e},login:function(){var a=b.defer(),c=function(){e=!0,a.resolve()};return h({immediate:!0}).then(c,function(){h().then(c,a.reject)}),a.promise},call:function(a,c,d,e,f){var g=f||{},h=b.defer();return window.gapi.client.load(a,c).then(function(){window.gapi.client[a][d][e](g).then(function(a){h.resolve(a.result)})}),h.promise}}}]});